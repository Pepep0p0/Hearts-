<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Museum of Us</title>

<style>
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: #fff5f7;
  color: #333;
  text-align: center;
}

.screen { display: none; padding: 24px; }
.screen.active { display: block; }

input, select, button {
  padding: 10px;
  margin: 8px;
  font-size: 16px;
}

button {
  background: #ff6f91;
  color: white;
  border: none;
  border-radius: 6px;
}

#avatar {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: pink;
  margin: 16px auto;
}

.artifacts {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

.artifact {
  width: 110px;
  height: 110px;
  background: #ffe0e6;
  border-radius: 12px;
  margin: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
}

.artifact.unlocked {
  background: #ffb3c7;
}

#coupon {
  border: 2px solid #333;
  padding: 24px;
  border-radius: 12px;
  background: #fffafc;
}
</style>
</head>

<body>

<div id="start" class="screen active">
  <h1>Museum of Us</h1>
  <p>Create your avatar to begin</p>
  <input id="first" placeholder="First Name">
  <input id="last" placeholder="Last Name">
  <br>
  <button onclick="startTour()">Start Tour ðŸŽ§</button>
</div>

<div id="museum" class="screen">
  <div id="avatar"></div>
  <h2 id="roomTitle"></h2>
  <div class="artifacts" id="artifacts"></div>
  <p id="kissCount">ðŸ’‹ 0 kisses</p>
</div>

<div id="valentine" class="screen">
  <h2>Will you be my Valentine?</h2>
  <label>
    <input type="checkbox" id="agree"> I agree to send Dedso rupiya
  </label>
  <br><br>
  <button onclick="finish()" id="finishBtn" disabled>Continue</button>
</div>

<div id="final" class="screen">
  <div id="coupon">
    <h2>Kiss Coupon</h2>
    <p id="finalName"></p>
    <p id="finalKisses"></p>
    <p>Redeemable anytime. No expiry.</p>
    <button onclick="downloadAnswers()">Download Answers (Curator)</button>
  </div>
</div>

<audio id="music" loop></audio>

<script>
const rooms = [
 ["Where did we first talk properly for hours?",
  "What was the first thing you noticed about me?",
  "What did you think this was going to be back then?"],

 ["What was the first fight we actually recovered from?",
  "Whatâ€™s something about us that surprised you?",
  "Whatâ€™s one thing we do that feels uniquely us?"],

 ["Which small moment of ours do I secretly love the most?",
  "When do you feel most at home with me?",
  "Whatâ€™s the one word youâ€™d use to describe us on our best day?"],

 ["What are you most excited to build together?",
  "What promise have I already kept without realizing it?",
  "What would you want us to remember this version of ourselves for?"]
];

let room = 0;
let kisses = 0;
let answers = [];

function startTour() {
  const first = document.getElementById("first").value.trim();
  const last = document.getElementById("last").value.trim();
  if (!first || !last) return alert("Enter both names");

  if (first.toLowerCase() === "amena" && last.toLowerCase() === "farooq") {
    kisses += 10;
  }

  localStorage.setItem("avatar", JSON.stringify({ first, last }));
  show("museum");
  loadRoom();

  document.getElementById("music").play();
}

function loadRoom() {
  document.getElementById("roomTitle").textContent = "Room " + (room + 1);
  const cont = document.getElementById("artifacts");
  cont.innerHTML = "";

  rooms[room].forEach((q, i) => {
    const d = document.createElement("div");
    d.className = "artifact";
    d.textContent = "Artifact";
    d.onclick = () => unlock(q, d);
    cont.appendChild(d);
  });

  updateKisses();
}

function unlock(question, el) {
  const a = prompt(question) || "";
  answers.push({ room: room+1, question, answer: a, time: new Date().toISOString() });
  el.classList.add("unlocked");
  el.textContent = "ðŸ’‹";
  kisses++;
  updateKisses();

  if ([...document.querySelectorAll(".artifact")].every(x => x.classList.contains("unlocked"))) {
    room++;
    room < rooms.length ? loadRoom() : show("valentine");
  }
}

function updateKisses() {
  document.getElementById("kissCount").textContent = "ðŸ’‹ " + kisses + " kisses";
}

document.getElementById("agree").onchange = e =>
  document.getElementById("finishBtn").disabled = !e.target.checked;

function finish() {
  show("final");
  const a = JSON.parse(localStorage.getItem("avatar"));
  document.getElementById("finalName").textContent = a.first + " " + a.last;
  document.getElementById("finalKisses").textContent = kisses + " kisses earned";
}

function show(id) {
  document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

function downloadAnswers() {
  const blob = new Blob([JSON.stringify(answers, null, 2)], { type: "application/json" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "museum_answers.json";
  a.click();
}
</script>

</body>
</html>